---
// WuxingTaiji ç»„ä»¶ - å¤ªæäº”è¡Œäº¤äº’ç³»ç»Ÿ
---

<div class="wuxing-taiji-container">
  <!-- æ ‡é¢˜åŒºåŸŸ -->
  <div class="section-header">
    <h2 class="section-title">â˜¯ äº”è¡Œç†”åˆ</h2>
    <p class="section-subtitle">é‡‘æœ¨æ°´ç«åœŸï¼Œé˜´é˜³æ—¥æœˆï¼Œä¸‡ç‰©å½’ä¸€</p>
  </div>

  <!-- å¤ªæä¸äº”è¡Œç¯ç»•åŒºåŸŸ -->
  <div class="taiji-universe">
    <!-- èƒ½é‡å…‰ç¯å±‚ -->
    <div id="energyRings" class="energy-rings"></div>

    <!-- è‡³é˜´ - æœˆ (å·¦ä¸Šè§’è½) -->
    <button
      class="yin-yang-element moon-element"
      data-element="æœˆ"
      title="æœˆ Â· è‡³é˜´"
    >
      <div class="element-glow moon-glow"></div>
      <span class="element-symbol">ğŸŒ™</span>
      <span class="element-label">è‡³é˜´</span>
    </button>

    <!-- è‡³é˜³ - æ—¥ (å³ä¸‹è§’è½) -->
    <button
      class="yin-yang-element sun-element"
      data-element="æ—¥"
      title="æ—¥ Â· è‡³é˜³"
    >
      <div class="element-glow sun-glow"></div>
      <span class="element-symbol">â˜€ï¸</span>
      <span class="element-label">è‡³é˜³</span>
    </button>

    <!-- å¤ªæä¸­å¿ƒ -->
    <div class="taiji-center">
      <div class="taiji-outer-ring"></div>
      <div class="taiji-inner-ring"></div>
      <svg viewBox="0 0 200 200" class="taiji-svg">
        <defs>
          <linearGradient id="yinGrad" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" style="stop-color:#1a1a2e"></stop>
            <stop offset="50%" style="stop-color:#2f4f4f"></stop>
            <stop offset="100%" style="stop-color:#0a0a15"></stop>
          </linearGradient>
          <linearGradient id="yangGrad" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" style="stop-color:#f8f8f0"></stop>
            <stop offset="50%" style="stop-color:#e8e4d4"></stop>
            <stop offset="100%" style="stop-color:#d4d0c0"></stop>
          </linearGradient>
          <filter id="shadowFilter">
            <feDropShadow dx="0" dy="2" stdDeviation="4" flood-opacity="0.4"
            ></feDropShadow>
          </filter>
          <filter id="innerGlow">
            <feGaussianBlur stdDeviation="2" result="coloredBlur"
            ></feGaussianBlur>
            <feMerge>
              <feMergeNode in="coloredBlur"></feMergeNode>
              <feMergeNode in="SourceGraphic"></feMergeNode>
            </feMerge>
          </filter>
        </defs>

        <!-- å¤ªææœ¬ä½“ - æŒç»­æ—‹è½¬ -->
        <g class="taiji-body" filter="url(#shadowFilter)">
          <!-- é˜´é±¼ -->
          <path
            d="M100,10 A90,90 0 0,1 100,190 A45,45 0 0,1 100,100 A45,45 0 0,0 100,10"
            fill="url(#yinGrad)"
            class="yin-fish"></path>
          <!-- é˜³é±¼ -->
          <path
            d="M100,10 A90,90 0 0,0 100,190 A45,45 0 0,0 100,100 A45,45 0 0,1 100,10"
            fill="url(#yangGrad)"
            class="yang-fish"></path>
          <!-- é˜´çœ¼ -->
          <circle
            cx="100"
            cy="55"
            r="12"
            fill="url(#yangGrad)"
            filter="url(#innerGlow)"></circle>
          <circle cx="100" cy="55" r="5" fill="url(#yinGrad)"></circle>
          <!-- é˜³çœ¼ -->
          <circle
            cx="100"
            cy="145"
            r="12"
            fill="url(#yinGrad)"
            filter="url(#innerGlow)"></circle>
          <circle cx="100" cy="145" r="5" fill="url(#yangGrad)"></circle>
        </g>
      </svg>
    </div>

    <!-- äº”è¡Œå…ƒç´ ç¯ç»• - äº”è§’æ˜Ÿå¸ƒå±€ -->
    <div class="wuxing-orbit">
      <!-- æ°´ - æ­£ä¸Šæ–¹ (åŒ—æ–¹) -->
      <button
        class="wuxing-btn wuxing-water"
        data-element="æ°´"
        data-position="north"
        title="æ°´ Â· æ¶¦ä¸‹"
      >
        <div class="element-glow water-glow"></div>
        <span class="element-icon">ğŸ’§</span>
        <span class="element-name">æ°´</span>
      </button>

      <!-- é‡‘ - å³ä¸Š (è¥¿æ–¹ååŒ—) -->
      <button
        class="wuxing-btn wuxing-metal"
        data-element="é‡‘"
        data-position="west-north"
        title="é‡‘ Â· ä»é©"
      >
        <div class="element-glow metal-glow"></div>
        <span class="element-icon">âš±ï¸</span>
        <span class="element-name">é‡‘</span>
      </button>

      <!-- åœŸ - å³ä¸‹ (ä¸­å¤®åè¥¿å—) -->
      <button
        class="wuxing-btn wuxing-earth"
        data-element="åœŸ"
        data-position="south-west"
        title="åœŸ Â· ç¨¼ç©‘"
      >
        <div class="element-glow earth-glow"></div>
        <span class="element-icon">ğŸ”ï¸</span>
        <span class="element-name">åœŸ</span>
      </button>

      <!-- æœ¨ - å·¦ä¸‹ (ä¸œæ–¹åå—) -->
      <button
        class="wuxing-btn wuxing-wood"
        data-element="æœ¨"
        data-position="south-east"
        title="æœ¨ Â· æ›²ç›´"
      >
        <div class="element-glow wood-glow"></div>
        <span class="element-icon">ğŸŒ¿</span>
        <span class="element-name">æœ¨</span>
      </button>

      <!-- ç« - å·¦ä¸Š (å—æ–¹åä¸œ) -->
      <button
        class="wuxing-btn wuxing-fire"
        data-element="ç«"
        data-position="east-north"
        title="ç« Â· ç‚ä¸Š"
      >
        <div class="element-glow fire-glow"></div>
        <span class="element-icon">ğŸ”¥</span>
        <span class="element-name">ç«</span>
      </button>
    </div>
  </div>

  <!-- é€‰ä¸­å…ƒç´ å±•ç¤º -->
  <div id="selectedDisplay" class="selected-display">
    <div class="selected-elements"></div>
    <span class="hint-text">âœ¨ ç‚¹å‡»å…ƒç´ å¼€å§‹äº”è¡Œç†”åˆ âœ¨</span>
  </div>

  <!-- æ“ä½œæŒ‰é’®åŒºåŸŸ -->
  <div class="action-buttons">
    <button id="fusionBtn" class="fusion-btn" disabled>
      <span class="btn-icon">â˜¯</span>
      <span class="btn-text">ç†” Â· åˆ</span>
      <div class="btn-glow"></div>
    </button>
    <button id="resetBtn" class="reset-btn">
      <span>ğŸ”„ é‡ç½®</span>
    </button>
  </div>

  <!-- ç†”åˆç»“æœå±•ç¤ºåŒºåŸŸ (ä¼˜åŒ–åå¸ƒå±€) -->
  <div id="fusionResultCard" class="fusion-result-card">
    <!-- ç­‰å¾…å ä½ç¬¦ -->
    <div id="resultPlaceholder" class="result-placeholder">
      <div class="placeholder-content">
        <div class="placeholder-orb">
          <span>ğŸŒ€</span>
        </div>
        <p class="placeholder-text">ç­‰å¾…å…ƒç´ ç†”åˆ...</p>
        <p class="placeholder-hint">é€‰æ‹©å…ƒç´ åç‚¹å‡»"ç†”åˆ"æŒ‰é’®</p>
      </div>
    </div>

    <!-- ç»“æœå±•ç¤ºå†…å®¹ -->
    <div id="fusionResult" class="fusion-result hidden">
      <!-- 1. æ ¸å¿ƒç»“æœï¼šå›¾æ ‡ä¸åç§° -->
      <div class="result-core-header">
        <div class="result-orb-container">
          <div class="result-orb">
            <span id="resultSymbol" class="result-symbol">â˜¯ï¸</span>
          </div>
          <div class="orb-ripple"></div>
        </div>

        <div class="result-title-group">
          <span class="result-label">FUSION COMPLETED</span>
          <h3 id="resultName" class="result-name">å¤ªå’Œ</h3>
          <!-- 2. ç†”åˆå…ƒç´  (Input) ç§»åˆ°æ ‡é¢˜ä¸‹æ–¹ä½œä¸º"æˆåˆ†"å±•ç¤º -->
          <div id="resultInputs" class="result-inputs"></div>
        </div>

        <!-- èƒŒæ™¯å¤§å­—è£…é¥° -->
        <div id="resultBgChar" class="result-bg-char">å’Œ</div>
      </div>

      <div class="result-divider"></div>

      <!-- 3. è¯—å¥ (Poem) - æ ¸å¿ƒæ°›å›´ -->
      <div class="result-poem-section">
        <div class="poem-quote-mark">â</div>
        <p id="resultPoem" class="result-poem">
          "é˜´é˜³é€ åŒ–å½’ä¸€ä½“ï¼Œä¸‡è±¡æ£®ç½—å…±å¤ªå’Œã€‚"
        </p>
        <div class="poem-quote-mark right">â</div>
      </div>

      <!-- 4. é‡Šä¹‰ (Meaning) - è¯¦ç»†è§£é‡Š -->
      <div class="result-meaning-section">
        <div class="meaning-label">
          <span>å¤©æœºé‡Šä¹‰</span>
          <div class="line"></div>
        </div>
        <p id="resultMeaning" class="result-meaning">
          äº”è¡Œç›¸ç”Ÿç›¸å…‹è¾¾æˆç»å¯¹å¹³è¡¡...
        </p>
      </div>
    </div>
  </div>
</div>

<style>
  .wuxing-taiji-container {
    position: relative;
    width: 100%;
    max-width: 680px; /* ç¨å¾®åŠ å®½ä¸€ç‚¹ */
    margin: 0 auto;
    padding: 15px; /* å‡å°‘å¤–å›´ Padding */
    box-sizing: border-box;
  }

  /* æ ‡é¢˜åŒºåŸŸ */
  .section-header {
    text-align: center;
    margin-bottom: 20px;
  }

  .section-title {
    font-size: 28px;
    font-weight: bold;
    color: var(--color-text);
    margin-bottom: 6px;
    letter-spacing: 4px;
  }

  .section-subtitle {
    font-size: 13px;
    color: var(--color-text-secondary);
    letter-spacing: 2px;
    opacity: 0.8;
  }

  /* å¤ªæå®‡å®™åŒºåŸŸ - ä¿æŒåŸæ ·ï¼Œé€‚å½“ç¼©å°ä¸€ç‚¹ä»¥é€‚åº”ç§»åŠ¨ç«¯ */
  .taiji-universe {
    position: relative;
    width: 300px; /* ç•¥å¾®è°ƒå°åŸºå‡†å°ºå¯¸ */
    height: 300px;
    margin: 0 auto 20px;
    --orbit-radius: 115px;
  }

  /* ... (æ­¤å¤„çœç•¥å¤ªæã€æ—¥æœˆã€äº”è¡ŒæŒ‰é’®çš„æ ·å¼ï¼Œä¿æŒåŸæ ·å³å¯ï¼Œä¸éœ€è¦åŠ¨) ... */
  /* åªéœ€è¦ç¡®ä¿ä»¥ä¸‹å‡ ä¸ªå…³é”®æ ·å¼å­˜åœ¨ */
  .energy-rings {
    position: absolute;
    inset: 0;
    pointer-events: none;
    z-index: 1;
  }
  .energy-ring {
    position: absolute;
    border-radius: 50%;
    opacity: 0;
    animation: ringPulse 2s ease-out forwards;
  }
  @keyframes ringPulse {
    0% {
      transform: scale(0.8);
      opacity: 0.8;
    }
    100% {
      transform: scale(1.5);
      opacity: 0;
    }
  }
  .taiji-center {
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    width: 120px;
    height: 120px;
    z-index: 5;
  }
  .taiji-outer-ring {
    position: absolute;
    inset: -18px;
    border-radius: 50%;
    border: 1px solid var(--color-border);
    opacity: 0.4;
    animation: ringRotate 30s linear infinite reverse;
  }
  .taiji-inner-ring {
    position: absolute;
    inset: -8px;
    border-radius: 50%;
    border: 1px dashed var(--color-accent);
    opacity: 0.3;
    animation: ringRotate 20s linear infinite;
  }
  @keyframes ringRotate {
    from {
      transform: rotate(0deg);
    }
    to {
      transform: rotate(360deg);
    }
  }
  .taiji-svg {
    width: 100%;
    height: 100%;
    filter: drop-shadow(0 0 25px rgba(0, 0, 0, 0.4));
  }
  .taiji-body {
    transform-origin: 100px 100px;
    animation: taijiRotate 20s linear infinite;
  }
  @keyframes taijiRotate {
    from {
      transform: rotate(0deg);
    }
    to {
      transform: rotate(360deg);
    }
  }
  .yin-yang-element {
    position: absolute;
    width: 50px;
    height: 50px;
    border-radius: 50%;
    border: 2px solid transparent;
    cursor: pointer;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    transition: all 0.4s;
    z-index: 15;
  }
  .moon-element {
    left: 0;
    top: 0;
    background: linear-gradient(135deg, #1a1a3a 0%, #3d3d6a 50%, #1a1a3a 100%);
  }
  .sun-element {
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, #5a4a00 0%, #9a7a20 50%, #5a4a00 100%);
  }
  .element-glow {
    position: absolute;
    inset: -10px;
    border-radius: 50%;
    opacity: 0;
    transition: opacity 0.3s ease;
    pointer-events: none;
  }
  .moon-glow {
    background: radial-gradient(
      circle,
      rgba(150, 150, 255, 0.8) 0%,
      transparent 70%
    );
  }
  .sun-glow {
    background: radial-gradient(
      circle,
      rgba(255, 200, 50, 0.8) 0%,
      transparent 70%
    );
  }
  .yin-yang-element:hover .element-glow,
  .yin-yang-element.selected .element-glow {
    opacity: 1;
  }
  .yin-yang-element.selected {
    transform: scale(1.15);
    border-color: white;
  }
  .element-symbol {
    font-size: 20px;
    line-height: 1;
  }
  .element-label {
    font-size: 9px;
    color: rgba(255, 255, 255, 0.85);
    margin-top: 2px;
    font-weight: 600;
  }
  .wuxing-orbit {
    position: absolute;
    inset: 0;
    z-index: 8;
  }
  .wuxing-btn {
    position: absolute;
    width: 54px;
    height: 54px;
    border-radius: 50%;
    border: 2px solid transparent;
    cursor: pointer;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    transition: all 0.4s;
    left: 50%;
    top: 50%;
    --angle: 0deg;
    --scale: 1;
    transform: translate(-50%, -50%) rotate(var(--angle))
      translate(0, calc(var(--orbit-radius) * -1))
      rotate(calc(var(--angle) * -1)) scale(var(--scale));
  }
  .wuxing-btn[data-position="north"] {
    --angle: -90deg;
  }
  .wuxing-btn[data-position="west-north"] {
    --angle: -18deg;
  }
  .wuxing-btn[data-position="south-west"] {
    --angle: 54deg;
  }
  .wuxing-btn[data-position="south-east"] {
    --angle: 126deg;
  }
  .wuxing-btn[data-position="east-north"] {
    --angle: 198deg;
  }
  .wuxing-btn:hover {
    --scale: 1.12;
    z-index: 20;
  }
  .wuxing-btn.selected {
    --scale: 1.2;
    border-color: white;
    z-index: 25;
  }
  .element-icon {
    font-size: 20px;
    z-index: 2;
  }
  .element-name {
    font-size: 10px;
    font-weight: bold;
    margin-top: 2px;
    z-index: 2;
  }
  .wuxing-btn .element-glow {
    inset: -10px;
  }
  /* Glow Colors */
  .metal-glow {
    background: radial-gradient(
      circle,
      rgba(255, 255, 255, 0.85) 0%,
      rgba(192, 192, 192, 0.4) 50%,
      transparent 70%
    );
  }
  .wood-glow {
    background: radial-gradient(
      circle,
      rgba(100, 200, 100, 0.85) 0%,
      rgba(50, 150, 50, 0.4) 50%,
      transparent 70%
    );
  }
  .water-glow {
    background: radial-gradient(
      circle,
      rgba(100, 150, 255, 0.85) 0%,
      rgba(50, 100, 200, 0.4) 50%,
      transparent 70%
    );
  }
  .fire-glow {
    background: radial-gradient(
      circle,
      rgba(255, 150, 50, 0.85) 0%,
      rgba(255, 80, 30, 0.4) 50%,
      transparent 70%
    );
  }
  .earth-glow {
    background: radial-gradient(
      circle,
      rgba(200, 150, 100, 0.85) 0%,
      rgba(150, 100, 50, 0.4) 50%,
      transparent 70%
    );
  }
  .wuxing-btn:hover .element-glow,
  .wuxing-btn.selected .element-glow {
    opacity: 1;
  }
  /* Button Colors */
  .wuxing-metal {
    background: linear-gradient(145deg, #f0f0f0 0%, #c0c0c0 50%, #909090 100%);
    color: #404040;
    box-shadow: 0 4px 15px rgba(192, 192, 192, 0.4);
  }
  .wuxing-wood {
    background: linear-gradient(145deg, #7dd87d 0%, #4a9c4a 50%, #2d7d2d 100%);
    color: #0a3a0a;
    box-shadow: 0 4px 15px rgba(100, 180, 100, 0.4);
  }
  .wuxing-water {
    background: linear-gradient(145deg, #6eb5ff 0%, #3d8bd8 50%, #1e5fa0 100%);
    color: #001a40;
    box-shadow: 0 4px 15px rgba(100, 150, 255, 0.4);
  }
  .wuxing-fire {
    background: linear-gradient(145deg, #ff8c42 0%, #e63b2e 50%, #b32424 100%);
    color: #400000;
    box-shadow: 0 4px 15px rgba(255, 100, 50, 0.4);
  }
  .wuxing-earth {
    background: linear-gradient(145deg, #d4a574 0%, #a67c52 50%, #785a3a 100%);
    color: #2a1a0a;
    box-shadow: 0 4px 15px rgba(180, 130, 80, 0.4);
  }

  /* é€‰ä¸­çŠ¶æ€æ˜¾ç¤º - ç®€åŒ– */
  .selected-display {
    text-align: center;
    min-height: 40px;
    margin-bottom: 16px;
  }
  .selected-elements {
    display: flex;
    justify-content: center;
    gap: 8px;
    flex-wrap: wrap;
    margin-bottom: 4px;
  }
  .selected-tag {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 6px 14px;
    border-radius: 20px;
    font-size: 14px;
    font-weight: 600;
    animation: tagAppear 0.3s ease;
  }
  @keyframes tagAppear {
    from {
      transform: scale(0.8);
      opacity: 0;
    }
    to {
      transform: scale(1);
      opacity: 1;
    }
  }
  .selected-tag.metal {
    background: linear-gradient(90deg, #e0e0e0, #c0c0c0);
    color: #404040;
  }
  .selected-tag.wood {
    background: linear-gradient(90deg, #7dd87d, #4a9c4a);
    color: #0a3a0a;
  }
  .selected-tag.water {
    background: linear-gradient(90deg, #6eb5ff, #3d8bd8);
    color: #001a40;
  }
  .selected-tag.fire {
    background: linear-gradient(90deg, #ff8c42, #e63b2e);
    color: #400000;
  }
  .selected-tag.earth {
    background: linear-gradient(90deg, #d4a574, #a67c52);
    color: #2a1a0a;
  }
  .selected-tag.sun {
    background: linear-gradient(90deg, #ffd700, #ff8c00);
    color: #4a3a00;
  }
  .selected-tag.moon {
    background: linear-gradient(90deg, #6a6aaa, #4a4a8a);
    color: #e0e0f0;
  }
  .hint-text {
    font-size: 13px;
    color: var(--color-text-secondary);
  }
  .selected-elements:not(:empty) + .hint-text {
    display: none;
  }

  /* æ“ä½œæŒ‰é’®åŒºåŸŸ - ç´§å‡‘åŒ– */
  .action-buttons {
    display: flex;
    justify-content: center;
    gap: 12px;
    margin-bottom: 20px;
  }

  /* èåˆæŒ‰é’® - é»‘ç™½èƒŒæ™¯ä¸‹å‡æ¸…æ™°å¯è§ */
  .fusion-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 12px 36px;
    border-radius: 25px;
    background: linear-gradient(
      135deg,
      #6366f1 0%,
      #8b5cf6 50%,
      #a855f7 100%
    );
    color: white;
    font-weight: bold;
    font-size: 16px;
    cursor: pointer;
    border: 2px solid rgba(255, 255, 255, 0.3);
    position: relative;
    overflow: hidden;
    box-shadow: 
      0 4px 15px rgba(99, 102, 241, 0.4),
      0 0 0 1px rgba(0, 0, 0, 0.1),
      inset 0 1px 0 rgba(255, 255, 255, 0.2);
    transition: all 0.3s ease;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
  }

  .fusion-btn:hover:not(:disabled) {
    transform: translateY(-2px);
    box-shadow: 
      0 6px 25px rgba(99, 102, 241, 0.5),
      0 0 0 1px rgba(0, 0, 0, 0.1),
      inset 0 1px 0 rgba(255, 255, 255, 0.3);
    border-color: rgba(255, 255, 255, 0.5);
  }

  .fusion-btn:active:not(:disabled) {
    transform: translateY(0);
    box-shadow: 
      0 2px 10px rgba(99, 102, 241, 0.4),
      inset 0 2px 4px rgba(0, 0, 0, 0.1);
  }

  .fusion-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    background: linear-gradient(
      135deg,
      #9ca3af 0%,
      #6b7280 100%
    );
    box-shadow: 
      0 2px 8px rgba(0, 0, 0, 0.15),
      inset 0 1px 0 rgba(255, 255, 255, 0.1);
  }

  .btn-icon {
    font-size: 20px;
    animation: iconSpin 10s linear infinite;
    filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.3));
  }

  .fusion-btn:disabled .btn-icon {
    animation: none;
  }

  .btn-text {
    letter-spacing: 2px;
  }

  @keyframes iconSpin {
    from {
      transform: rotate(0deg);
    }
    to {
      transform: rotate(360deg);
    }
  }

  .btn-glow {
    position: absolute;
    inset: 0;
    background: linear-gradient(
      45deg,
      transparent 30%,
      rgba(255, 255, 255, 0.25) 50%,
      transparent 70%
    );
    background-size: 200% 100%;
    animation: shimmer 2.5s ease-in-out infinite;
  }

  .fusion-btn:disabled .btn-glow {
    animation: none;
    opacity: 0;
  }

  @keyframes shimmer {
    from {
      background-position: 200% 0;
    }
    to {
      background-position: -200% 0;
    }
  }

  /* é‡ç½®æŒ‰é’® - åŒæ ·ä¼˜åŒ– */
  .reset-btn {
    padding: 12px 20px;
    border-radius: 25px;
    background: var(--color-bg-secondary);
    color: var(--color-text);
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    border: 2px solid var(--color-border);
    box-shadow: 
      0 2px 8px rgba(0, 0, 0, 0.1),
      inset 0 1px 0 rgba(255, 255, 255, 0.1);
    transition: all 0.3s ease;
  }

  .reset-btn:hover {
    background: var(--color-bg);
    border-color: var(--color-accent);
    color: var(--color-accent);
    transform: translateY(-1px);
    box-shadow: 
      0 4px 12px rgba(0, 0, 0, 0.15),
      inset 0 1px 0 rgba(255, 255, 255, 0.15);
  }

  .reset-btn:active {
    transform: translateY(0);
  }

  /* === ç†”åˆç»“æœå¡ç‰‡å®¹å™¨ - é‡ç‚¹ä¼˜åŒ– === */
  .fusion-result-card {
    background: var(--color-card);
    border-radius: 12px;
    border: 1px solid var(--color-border);
    overflow: hidden;
    min-height: 280px;
    display: flex;
    flex-direction: column;
    width: 100%; /* ç¡®ä¿æ’‘æ»¡å®¹å™¨ */
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
  }

  /* ç»“æœå±•ç¤ºå¡ç‰‡ */
  .fusion-result {
    /* å‡å°‘å·¦å³ Paddingï¼Œå¢åŠ ç©ºé—´ */
    padding: 24px 16px;
    height: 100%;
    display: flex;
    flex-direction: column;
    gap: 16px;
    position: relative;
    box-sizing: border-box;
    width: 100%;
  }

  .fusion-result.hidden {
    display: none;
  }

  /* 1. å¤´éƒ¨åŒºåŸŸï¼šå›¾æ ‡ + åå­— + è¾“å…¥ */
  .result-core-header {
    display: flex;
    align-items: center; /* å‚ç›´å±…ä¸­ */
    gap: 16px;
    position: relative;
    z-index: 2;
    width: 100%;
  }

  /* å›¾æ ‡å…‰çƒ - ç¨å¾®ç¼©å°ä»¥é€‚åº”çª„å± */
  .result-orb-container {
    position: relative;
    width: 60px; /* ç¼©å° */
    height: 60px; /* ç¼©å° */
    flex-shrink: 0; /* é˜²æ­¢è¢«æŒ¤å‹ */
  }

  .result-orb {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--color-accent), #4a3b69);
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 0 15px rgba(var(--color-accent-rgb), 0.4);
    border: 2px solid rgba(255, 255, 255, 0.15);
    z-index: 2;
  }

  .result-symbol {
    font-size: 30px; /* ç¼©å° */
    line-height: 1;
  }

  .orb-ripple {
    position: absolute;
    inset: -4px;
    border-radius: 50%;
    border: 1px solid var(--color-accent);
    opacity: 0;
    animation: ripple 2s infinite;
    z-index: 1;
  }
  @keyframes ripple {
    0% {
      transform: scale(1);
      opacity: 0.6;
    }
    100% {
      transform: scale(1.4);
      opacity: 0;
    }
  }

  /* æ ‡é¢˜ç»„ */
  .result-title-group {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    min-width: 0; /* å…³é”®ï¼šå…è®¸Flexå­é¡¹æ”¶ç¼© */
  }

  .result-label {
    font-size: 10px;
    color: var(--color-text-muted);
    letter-spacing: 1px;
    text-transform: uppercase;
    margin-bottom: 2px;
  }

  .result-name {
    font-size: 28px; /* ç¼©å°ä¸€ç‚¹é˜²æ­¢æ¢è¡Œ */
    font-weight: bold;
    color: #fff;
    text-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
    margin: 0 0 6px 0;
    font-family: "KaiTi", "æ¥·ä½“", "STKaiti", serif;
    line-height: 1.1;
    white-space: nowrap; /* å°½é‡ä¸æ¢è¡Œ */
  }

  .result-inputs {
    display: flex;
    gap: 5px;
    flex-wrap: wrap;
  }

  .result-input-tag {
    font-size: 10px;
    padding: 2px 6px;
    border-radius: 4px;
    background: rgba(255, 255, 255, 0.12);
    border: 1px solid rgba(255, 255, 255, 0.25);
    color: rgba(255, 255, 255, 0.9);
  }

  /* èƒŒæ™¯å¤§å­— - è°ƒæ•´ä½ç½®é˜²æ­¢é®æŒ¡ */
  .result-bg-char {
    position: absolute;
    right: -10px;
    top: -15px;
    font-size: 100px;
    font-family: "KaiTi", "æ¥·ä½“", serif;
    color: white;
    opacity: 0.04;
    pointer-events: none;
    z-index: 0;
  }

  /* 3. è¯—å¥åŒºåŸŸ (Poem) - å½»åº•é‡æ„ï¼Œå¢åŠ å®½åº¦ */
  .result-poem-section {
    text-align: center;
    /* å»æ‰ä¹‹å‰çš„æ·±è‰²èƒŒæ™¯ï¼Œæ”¹ä¸ºé€šé€è®¾è®¡ */
    padding: 16px 0;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    position: relative;
    width: 100%; /* å¼ºåˆ¶å æ»¡å®½åº¦ */
    margin-top: 8px;
  }

  .result-poem {
    font-family: "KaiTi", "æ¥·ä½“", "Songti SC", serif;
    font-size: 18px; /* ä¿æŒå¤§å­—ä½“ */
    color: var(--color-text, #e0e0e0);
    line-height: 1.5;
    margin: 0;
    font-style: normal;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
    writing-mode: horizontal-tb;
    /* å…è®¸æ–‡æœ¬è‡ªç„¶æ¢è¡Œï¼Œä½†å› ä¸ºå®½åº¦å¤Ÿäº†ï¼Œä¸ä¼šé¢‘ç¹æ¢è¡Œ */
    padding: 0 10px;
  }

  .poem-quote-mark {
    display: none;
  } /* åœ¨çª„å±ä¸‹å¼•å·å¤ªå ä½ç½®ï¼Œéšè—æˆ–æ”¹ä¸ºèƒŒæ™¯ */

  /* 4. é‡Šä¹‰åŒºåŸŸ (Meaning) */
  .result-meaning-section {
    padding: 0;
    width: 100%;
  }

  .meaning-label {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 6px;
  }

  .meaning-label span {
    font-size: 11px;
    color: var(--color-text-secondary, #aaa);
    font-weight: bold;
    flex-shrink: 0;
  }

  .meaning-label .line {
    height: 1px;
    background: rgba(255, 255, 255, 0.1);
    flex: 1;
  }

  .result-meaning {
    font-size: 13px;
    color: var(--color-text-secondary, #ccc);
    line-height: 1.6;
    margin: 0;
    /* å–æ¶ˆ justifyï¼Œé˜²æ­¢å­—æ•°å°‘æ—¶æ‹‰ä¼¸éš¾çœ‹ */
    text-align: left;
    writing-mode: horizontal-tb;
    opacity: 0.9;
  }

  /* å ä½ç¬¦æ ·å¼å¾®è°ƒ */
  .result-placeholder {
    padding: 40px 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
    width: 100%;
    box-sizing: border-box;
  }
  .result-placeholder.hidden {
    display: none;
  }
  .placeholder-orb {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: var(--color-bg-secondary);
    border: 2px dashed var(--color-border);
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 12px;
    font-size: 24px;
    opacity: 0.7;
  }
  .placeholder-text {
    font-size: 15px;
    color: var(--color-text-secondary);
    margin: 0 0 4px 0;
  }
  .placeholder-hint {
    font-size: 12px;
    color: var(--color-text-muted);
    margin: 0;
  }

  /* èåˆåŠ¨ç”» */
  .fusion-animating .taiji-body {
    animation: taijiRotate 2s linear infinite;
  }
  .fusion-animating .wuxing-btn.selected,
  .fusion-animating .yin-yang-element.selected {
    animation: elementPulse 0.5s ease infinite;
  }
  @keyframes elementPulse {
    0%,
    100% {
      transform: translate(-50%, -50%) rotate(var(--angle))
        translate(0, calc(var(--orbit-radius) * -1))
        rotate(calc(var(--angle) * -1)) scale(1.2);
    }
    50% {
      transform: translate(-50%, -50%) rotate(var(--angle))
        translate(0, calc(var(--orbit-radius) * -1))
        rotate(calc(var(--angle) * -1)) scale(1.35);
    }
  }

  /* æçª„å±å¹•é€‚é… */
  @media (max-width: 360px) {
    .taiji-universe {
      transform: scale(0.9);
      margin-bottom: 10px;
    }
    .fusion-result {
      padding: 20px 12px;
    } /* è¿›ä¸€æ­¥å‡å°‘å†…è¾¹è· */
    .result-name {
      font-size: 24px;
    }
    .result-orb-container {
      width: 50px;
      height: 50px;
    }
    .result-symbol {
      font-size: 24px;
    }
  }
</style>
<script>
  // çŠ¶æ€ç®¡ç†
  let selectedElements: Set<string> = new Set();
  let fusionData: Array<{
    inputs: string[];
    name: string;
    symbol: string;
    meaning: string;
    poem: string;
  }> = [];

  // å…ƒç´ æ˜ å°„
  const elementMap: Record<
    string,
    { name: string; class: string; color: string }
  > = {
    é‡‘: { name: "metal", class: "metal", color: "rgba(192, 192, 192, 0.6)" },
    æœ¨: { name: "wood", class: "wood", color: "rgba(100, 180, 100, 0.6)" },
    æ°´: { name: "water", class: "water", color: "rgba(100, 150, 255, 0.6)" },
    ç«: { name: "fire", class: "fire", color: "rgba(255, 100, 50, 0.6)" },
    åœŸ: { name: "earth", class: "earth", color: "rgba(180, 130, 80, 0.6)" },
    æ—¥: { name: "sun", class: "sun", color: "rgba(255, 200, 50, 0.6)" },
    æœˆ: { name: "moon", class: "moon", color: "rgba(150, 150, 255, 0.6)" },
  };

  // é»˜è®¤èåˆç»“æœ
  const defaultFusion: {
    inputs: string[];
    name: string;
    symbol: string;
    meaning: string;
    poem: string;
  } = {
    inputs: [],
    name: "æ··æ²Œ",
    symbol: "ğŸŒ€",
    meaning:
      "å…ƒç´ é—´å‰§çƒˆæ¿€è¡ï¼Œå½’äºå¤ªæä¹‹å§‹ï¼Œä¸‡ç‰©å°šåœ¨å­•è‚²ä¹‹ä¸­ã€‚é“æ³•è‡ªç„¶ï¼Œæ— åå¤©åœ°ä¹‹å§‹ã€‚",
    poem: "é“ç”Ÿä¸€ï¼Œä¸€ç”ŸäºŒï¼ŒäºŒç”Ÿä¸‰ï¼Œä¸‰ç”Ÿä¸‡ç‰©ã€‚",
  };

  // åŠ è½½èåˆæ•°æ®
  async function loadFusionData() {
    try {
      const response = await fetch("/WuxingFusion.json");
      fusionData = await response.json();
    } catch (error) {
      console.error("Failed to load fusion data:", error);
      fusionData = [defaultFusion];
    }
  }

  // åˆå§‹åŒ–
  loadFusionData();

  // è·å–å…ƒç´ 
  const wuxingBtns = document.querySelectorAll(".wuxing-btn");
  const yinYangBtns = document.querySelectorAll(".yin-yang-element");
  const fusionBtn = document.getElementById("fusionBtn") as HTMLButtonElement;
  const resetBtn = document.getElementById("resetBtn") as HTMLButtonElement;
  const selectedDisplay = document.getElementById("selectedDisplay");
  const fusionResult = document.getElementById("fusionResult");
  const resultPlaceholder = document.getElementById("resultPlaceholder");
  const resultSymbol = document.getElementById("resultSymbol");
  const resultName = document.getElementById("resultName");
  const resultPoem = document.getElementById("resultPoem");
  const resultMeaning = document.getElementById("resultMeaning");
  const resultInputs = document.getElementById("resultInputs");
  const resultBgChar = document.getElementById("resultBgChar");
  const energyRings = document.getElementById("energyRings");
  const taijiUniverse = document.querySelector(".taiji-universe");

  // æ›´æ–°é€‰ä¸­çŠ¶æ€æ˜¾ç¤º
  function updateDisplay() {
    const selectedContainer =
      selectedDisplay?.querySelector(".selected-elements");
    if (!selectedContainer) return;

    selectedContainer.innerHTML = "";

    selectedElements.forEach((el) => {
      const info = elementMap[el];
      if (info) {
        const tag = document.createElement("span");
        tag.className = `selected-tag ${info.class}`;
        tag.innerHTML = `<span>${el}</span>`;
        selectedContainer.appendChild(tag);
      }
    });

    // æ›´æ–°èåˆæŒ‰é’®çŠ¶æ€
    const canFuse = selectedElements.size >= 1;
    fusionBtn.disabled = !canFuse;
  }

  // åˆ›å»ºèƒ½é‡å…‰ç¯
  function createEnergyRing(element: string) {
    const info = elementMap[element];
    if (!info || !energyRings) return;

    const ring = document.createElement("div");
    ring.className = "energy-ring";
    ring.style.cssText = `
      inset: 60px;
      border: 3px solid ${info.color};
      box-shadow: 0 0 25px ${info.color};
    `;
    energyRings.appendChild(ring);

    setTimeout(() => ring.remove(), 2000);
  }

  // å…ƒç´ ç‚¹å‡»å¤„ç†
  function handleElementClick(btn: Element, element: string) {
    if (selectedElements.has(element)) {
      selectedElements.delete(element);
      btn.classList.remove("selected");
    } else {
      selectedElements.add(element);
      btn.classList.add("selected");
      createEnergyRing(element);
    }

    // éšè—ä¹‹å‰çš„èåˆç»“æœ
    fusionResult?.classList.add("hidden");
    resultPlaceholder?.classList.remove("hidden");
    updateDisplay();
  }

  // äº”è¡Œå…ƒç´ ç‚¹å‡»
  wuxingBtns.forEach((btn) => {
    btn.addEventListener("click", () => {
      const element = (btn as HTMLElement).dataset.element!;
      handleElementClick(btn, element);
    });
  });

  // æ—¥æœˆå…ƒç´ ç‚¹å‡»
  yinYangBtns.forEach((btn) => {
    btn.addEventListener("click", () => {
      const element = (btn as HTMLElement).dataset.element!;
      handleElementClick(btn, element);
    });
  });

  // æŸ¥æ‰¾èåˆç»“æœ
  function findFusionResult(inputs: string[]): typeof defaultFusion {
    // æ’åºè¾“å…¥ä»¥ä¾¿åŒ¹é…
    const sortedInputs = [...inputs].sort();

    for (const fusion of fusionData) {
      const sortedFusionInputs = [...fusion.inputs].sort();
      if (
        sortedInputs.length === sortedFusionInputs.length &&
        sortedInputs.every((v, i) => v === sortedFusionInputs[i])
      ) {
        return fusion;
      }
    }

    return defaultFusion;
  }

  // èåˆæŒ‰é’®ç‚¹å‡»
  fusionBtn?.addEventListener("click", async () => {
    if (selectedElements.size === 0) return;

    // æ·»åŠ èåˆåŠ¨ç”»
    taijiUniverse?.classList.add("fusion-animating");
    fusionBtn.disabled = true;

    // ç­‰å¾…åŠ¨ç”»
    await new Promise((resolve) => setTimeout(resolve, 1500));

    // è·å–èåˆç»“æœ
    const inputs = Array.from(selectedElements);
    const result = findFusionResult(inputs);

    // æ˜¾ç¤ºç»“æœ
    if (resultSymbol) resultSymbol.textContent = result.symbol;
    if (resultName) resultName.textContent = result.name;
    if (resultPoem) resultPoem.textContent = `"${result.poem}"`;
    if (resultMeaning) resultMeaning.textContent = result.meaning;

    // è®¾ç½®èƒŒæ™¯å¤§å­— - å–åå­—çš„ç¬¬ä¸€ä¸ªå­—
    if (resultBgChar) {
      resultBgChar.textContent = result.name.charAt(0);
    }

    if (resultInputs) {
      resultInputs.innerHTML = inputs
        .map((el) => `<span class="result-input-tag">${el}</span>`)
        .join("");
    }

    // åˆ‡æ¢æ˜¾ç¤º
    resultPlaceholder?.classList.add("hidden");
    fusionResult?.classList.remove("hidden");

    // ç§»é™¤åŠ¨ç”»ç±»
    taijiUniverse?.classList.remove("fusion-animating");
    fusionBtn.disabled = false;
  });

  // é‡ç½®æŒ‰é’®ç‚¹å‡»
  resetBtn?.addEventListener("click", () => {
    selectedElements.clear();

    // ç§»é™¤æ‰€æœ‰é€‰ä¸­çŠ¶æ€
    wuxingBtns.forEach((btn) => btn.classList.remove("selected"));
    yinYangBtns.forEach((btn) => btn.classList.remove("selected"));

    // é‡ç½®æ˜¾ç¤º
    fusionResult?.classList.add("hidden");
    resultPlaceholder?.classList.remove("hidden");
    updateDisplay();
  });
</script>
